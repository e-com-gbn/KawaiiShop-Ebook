<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D√©tails du Produit | KAWAII SHOP</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .product-container {
            max-width: 1000px;
            margin: 30px auto;
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            padding: 20px;
        }
        .image-selection {
            flex: 1;
            min-width: 300px;
            text-align: center;
        }
        .image-selection img {
            width: 100%;
            max-width: 400px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 3px solid var(--primary-red);
        }
        .info-selection {
            flex: 1.2;
            min-width: 300px;
        }
        .info-selection h1 {
            font-family: 'Bangers', cursive;
            font-size: 3rem;
            margin-bottom: 10px;
        }
        .price-tag {
            font-size: 2rem;
            color: var(--primary-red);
            font-weight: 800;
            margin: 15px 0;
        }
        .order-box {
            background: #fff;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #eee;
            margin-top: 20px;
        }
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            margin-top: 15px;
        }
        input, select {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1.5px solid #ddd;
            font-weight: bold;
        }
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }
        .btn-glow {
            width: 100%;
            padding: 18px;
            font-size: 1.1rem;
            font-family: 'Bangers', cursive;
            letter-spacing: 1px;
        }
    </style>
</head>
<body>

    <header class="main-header">
        <a href="index.html" class="logo">KAWAII <span>SHOP</span></a>
        <div class="menu-toggle" id="mobile-menu">
            <span class="bar"></span><span class="bar"></span><span class="bar"></span>
        </div>
        <nav class="nav-menu">
            <a href="index.html">Accueil</a>
            <a href="category.html?genre=action">Action</a>
            <a href="category.html?genre=fantasy">Fantaisie</a>
            <a href="cart.html" class="cart-link">üõí BUTIN (<span class="cart-count">0</span>)</a>
        </nav>
    </header>

    <main>
        <div class="product-container">
            <div class="image-selection">
                <img id="main-product-img" src="" alt="Chargement...">
            </div>

            <div class="info-selection">
                <h1 id="product-title">Chargement...</h1>
                <p id="product-meta" style="font-weight: bold; color: #666;"></p>
                <div class="price-tag"><span id="product-price">0</span> FCFA</div>
                
                <p id="product-description" style="line-height: 1.6; color: #444; margin-bottom: 20px;"></p>

                <div class="order-box">
                    <div id="volume-range-display" style="font-weight: 800; color: var(--primary-red); margin-bottom: 15px;"></div>
                    
                    <label for="volume-number">NUM√âRO DU TOME :</label>
                    <input type="number" id="volume-number" value="1">

                    <label for="payment-method-direct">MODE DE PAIEMENT :</label>
                    <select id="payment-method-direct">
                        <option value="Airtel Money">Airtel Money üî¥</option>
                        <option value="Moov Money / Mobicash">Mobicash üîµ</option>
                    </select>

                    <div class="action-buttons">
                        <button type="button" id="add-to-cart-btn" class="btn-glow blue">
                            AJOUTER AU BUTIN üõí
                        </button>
                        
                        <button type="button" id="buy-whatsapp-btn" class="btn-glow gold">
                            ACHAT DIRECT WHATSAPP üì±
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="data.js"></script>
    <script src="script.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 1. R√©cup√©ration de l'ID
            const urlParams = new URLSearchParams(window.location.search);
            const productId = parseInt(urlParams.get('id'));
            
            // 2. Recherche du produit
            const p = ALL_PRODUCTS.find(item => item.id === productId);

            if (p) {
                // Affichage des donn√©es
                document.getElementById('product-title').innerText = p.title;
                document.getElementById('product-price').innerText = p.price.toLocaleString();
                document.getElementById('main-product-img').src = p.imageUrl;
                document.getElementById('product-description').innerText = p.summary || "Plongez dans cette aventure incroyable disponible chez Kawaii Shop !";
                document.getElementById('product-meta').innerText = `${p.genre} | Tome Unique ou S√©rie`;

                if (p.minVolume && p.maxVolume) {
                    document.getElementById('volume-range-display').innerText = `üì¶ Disponibles : Tomes ${p.minVolume} √† ${p.maxVolume}`;
                    document.getElementById('volume-number').min = p.minVolume;
                    document.getElementById('volume-number').max = p.maxVolume;
                    document.getElementById('volume-number').value = p.minVolume;
                }

                // 3. ACTION : AJOUTER AU PANIER (Correction Mobile)
                document.getElementById('add-to-cart-btn').onclick = function() {
                    const selectedVol = document.getElementById('volume-number').value;
                    // On appelle la fonction de script.js
                    if (typeof addToCart === "function") {
                        addToCart(p.id, selectedVol);
                    } else {
                        alert("Erreur: Script de panier non charg√©.");
                    }
                };

                // 4. ACTION : WHATSAPP DIRECT
                document.getElementById('buy-whatsapp-btn').onclick = function() {
                    const vol = document.getElementById('volume-number').value;
                    const methode = document.getElementById('payment-method-direct').value;
                    const message = `Bonjour KAWAII SHOP ! üè¥‚Äç‚ò†Ô∏è\n\nJe veux commander en direct :\n‚ú® *Produit* : ${p.title}\nüî¢ *Volume* : ${vol}\nüí∞ *Prix* : ${p.price.toLocaleString()} FCFA\nüí≥ *Paiement* : ${methode}`;
                    
                    const waUrl = `https://wa.me/24162636600?text=${encodeURIComponent(message)}`;
                    window.location.href = waUrl;
                };

            } else {
                document.querySelector('main').innerHTML = "<h2 style='text-align:center; padding:50px;'>Produit non trouv√©... <a href='index.html'>Retour √† l'accueil</a></h2>";
            }
        });
    </script>
</body>
</html>
